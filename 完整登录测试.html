<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>å›¾ä¹¦ç®¡ç†ç³»ç»Ÿ - å®Œæ•´ç™»å½•æµ‹è¯•</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        .account-section { 
            margin: 20px 0; 
            padding: 20px; 
            border: 2px solid #ddd; 
            border-radius: 8px;
            background: #f9f9f9;
        }
        .admin-section { border-color: #ff6b6b; background: #fff5f5; }
        .reader-section { border-color: #4ecdc4; background: #f0fdfc; }
        
        button { 
            padding: 12px 24px; 
            margin: 8px; 
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        .admin-btn { background: #ff6b6b; color: white; }
        .admin-btn:hover { background: #ff5252; transform: translateY(-2px); }
        
        .reader-btn { background: #4ecdc4; color: white; }
        .reader-btn:hover { background: #26d0ce; transform: translateY(-2px); }
        
        .test-btn { background: #6c5ce7; color: white; }
        .test-btn:hover { background: #5f3dc4; transform: translateY(-2px); }
        
        .success { color: #00b894; font-weight: bold; }
        .error { color: #e17055; font-weight: bold; }
        .info { color: #0984e3; font-weight: bold; }
        
        textarea { 
            width: 100%; 
            height: 200px; 
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            font-family: monospace;
        }
        
        .account-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .account-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #4ecdc4;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .quick-login {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 5px 0;
        }
        
        .quick-login input {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
            width: 100px;
        }
        
        h1 { color: #2d3436; text-align: center; }
        h2 { color: #636e72; }
        h3 { color: #74b9ff; }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-online { background: #00b894; }
        .status-offline { background: #e17055; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“š å›¾ä¹¦ç®¡ç†ç³»ç»Ÿ - å®Œæ•´ç™»å½•æµ‹è¯•</h1>
        
        <!-- ç³»ç»ŸçŠ¶æ€æ£€æŸ¥ -->
        <div class="account-section">
            <h3>ğŸ”§ ç³»ç»ŸçŠ¶æ€æ£€æŸ¥</h3>
            <button class="test-btn" onclick="checkSystemStatus()">æ£€æŸ¥ç³»ç»ŸçŠ¶æ€</button>
            <button class="test-btn" onclick="testDatabaseConnection()">æµ‹è¯•æ•°æ®åº“è¿æ¥</button>
            <div id="systemStatus"></div>
        </div>

        <!-- ç®¡ç†å‘˜è´¦å· -->
        <div class="account-section admin-section">
            <h2>ğŸ‘¨â€ğŸ’¼ ç®¡ç†å‘˜ç™»å½•</h2>
            <p><strong>ç®¡ç†å‘˜è´¦å·ä¿¡æ¯ï¼š</strong></p>
            <div class="quick-login">
                <span class="status-indicator status-online"></span>
                <strong>è´¦å·ID:</strong> <input type="text" id="adminId" value="20170001" readonly>
                <strong>å¯†ç :</strong> <input type="password" id="adminPass" value="111111" readonly>
                <button class="admin-btn" onclick="testAdminLogin()">ç®¡ç†å‘˜ç™»å½•æµ‹è¯•</button>
            </div>
            <div id="adminResult"></div>
        </div>

        <!-- è¯»è€…è´¦å· -->
        <div class="account-section reader-section">
            <h2>ğŸ‘¥ è¯»è€…ç™»å½•</h2>
            <p><strong>å¯ç”¨è¯»è€…è´¦å·ï¼ˆå¯†ç ç»Ÿä¸€ä¸ºï¼š111111ï¼‰ï¼š</strong></p>
            
            <div class="account-grid">
                <div class="account-item">
                    <h4>ğŸ‘¨ å¼ å</h4>
                    <div class="quick-login">
                        <span class="status-indicator status-online"></span>
                        <strong>ID:</strong> <input type="text" value="1501014101" readonly>
                        <button class="reader-btn" onclick="testReaderLogin('1501014101', '111111', 'å¼ å')">ç™»å½•æµ‹è¯•</button>
                    </div>
                </div>
                
                <div class="account-item">
                    <h4>ğŸ‘¨ ç‹å°ä¼Ÿ</h4>
                    <div class="quick-login">
                        <span class="status-indicator status-online"></span>
                        <strong>ID:</strong> <input type="text" value="1501014102" readonly>
                        <button class="reader-btn" onclick="testReaderLogin('1501014102', '111111', 'ç‹å°ä¼Ÿ')">ç™»å½•æµ‹è¯•</button>
                    </div>
                </div>
                
                <div class="account-item">
                    <h4>ğŸ‘© ç‹èå°”</h4>
                    <div class="quick-login">
                        <span class="status-indicator status-online"></span>
                        <strong>ID:</strong> <input type="text" value="1501014103" readonly>
                        <button class="reader-btn" onclick="testReaderLogin('1501014103', '111111', 'ç‹èå°”')">ç™»å½•æµ‹è¯•</button>
                    </div>
                </div>
                
                <div class="account-item">
                    <h4>ğŸ‘¨ å¼ æ˜å</h4>
                    <div class="quick-login">
                        <span class="status-indicator status-online"></span>
                        <strong>ID:</strong> <input type="text" value="1501014104" readonly>
                        <button class="reader-btn" onclick="testReaderLogin('1501014104', '111111', 'å¼ æ˜å')">ç™»å½•æµ‹è¯•</button>
                    </div>
                </div>
                
                <div class="account-item">
                    <h4>ğŸ‘¨ æä¸€ç›</h4>
                    <div class="quick-login">
                        <span class="status-indicator status-online"></span>
                        <strong>ID:</strong> <input type="text" value="1501014105" readonly>
                        <button class="reader-btn" onclick="testReaderLogin('1501014105', '111111', 'æä¸€ç›')">ç™»å½•æµ‹è¯•</button>
                    </div>
                </div>
                
                <div class="account-item">
                    <h4>ğŸ‘¨ æäºŒé£</h4>
                    <div class="quick-login">
                        <span class="status-indicator status-online"></span>
                        <strong>ID:</strong> <input type="text" value="1501014106" readonly>
                        <button class="reader-btn" onclick="testReaderLogin('1501014106', '111111', 'æäºŒé£')">ç™»å½•æµ‹è¯•</button>
                    </div>
                </div>
            </div>
            
            <div id="readerResult"></div>
        </div>

        <!-- è‡ªå®šä¹‰ç™»å½•æµ‹è¯• -->
        <div class="account-section">
            <h3>ğŸ”§ è‡ªå®šä¹‰ç™»å½•æµ‹è¯•</h3>
            <div class="quick-login">
                <strong>è´¦å·ID:</strong> <input type="text" id="customId" placeholder="è¾“å…¥è´¦å·ID">
                <strong>å¯†ç :</strong> <input type="password" id="customPass" placeholder="è¾“å…¥å¯†ç ">
                <button class="test-btn" onclick="testCustomLogin()">è‡ªå®šä¹‰ç™»å½•æµ‹è¯•</button>
            </div>
            <div id="customResult"></div>
        </div>

        <!-- è°ƒè¯•æ—¥å¿— -->
        <div class="account-section">
            <h3>ğŸ“‹ è°ƒè¯•æ—¥å¿—</h3>
            <textarea id="debugLog" readonly placeholder="æ—¥å¿—å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
            <br>
            <button class="test-btn" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
            <button class="test-btn" onclick="exportLog()">å¯¼å‡ºæ—¥å¿—</button>
        </div>

        <!-- å¿«é€Ÿé“¾æ¥ -->
        <div class="account-section">
            <h3>ğŸ”— å¿«é€Ÿé“¾æ¥</h3>
            <button class="test-btn" onclick="openMainPage()">æ‰“å¼€ä¸»ç™»å½•é¡µé¢</button>
            <button class="admin-btn" onclick="openAdminPage()">ç®¡ç†å‘˜åå°</button>
            <button class="reader-btn" onclick="openReaderPage()">è¯»è€…é¡µé¢</button>
        </div>
    </div>

    <script>
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const debugLog = document.getElementById('debugLog');
            const typeEmoji = {
                'info': 'â„¹ï¸',
                'success': 'âœ…',
                'error': 'âŒ',
                'warning': 'âš ï¸'
            };
            debugLog.value += `[${timestamp}] ${typeEmoji[type] || 'â„¹ï¸'} ${message}\n`;
            debugLog.scrollTop = debugLog.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        function clearLog() {
            document.getElementById('debugLog').value = '';
            log('æ—¥å¿—å·²æ¸…ç©º', 'info');
        }

        function exportLog() {
            const logContent = document.getElementById('debugLog').value;
            const blob = new Blob([logContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å›¾ä¹¦ç®¡ç†ç³»ç»Ÿç™»å½•æµ‹è¯•æ—¥å¿—_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            log('æ—¥å¿—å·²å¯¼å‡º', 'success');
        }

        function updateResult(elementId, message, isSuccess) {
            const element = document.getElementById(elementId);
            element.innerHTML = message;
            element.className = isSuccess ? 'success' : 'error';
        }

        function checkSystemStatus() {
            log('å¼€å§‹æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...', 'info');
            fetch('http://localhost:9000/')
                .then(response => {
                    log(`æœåŠ¡å™¨å“åº”çŠ¶æ€: ${response.status}`, response.ok ? 'success' : 'error');
                    if (response.ok) {
                        updateResult('systemStatus', 'âœ… ç³»ç»Ÿè¿è¡Œæ­£å¸¸ (ç«¯å£9000)', true);
                        return response.text();
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                })
                .then(html => {
                    log('ç³»ç»Ÿä¸»é¡µé¢åŠ è½½æˆåŠŸ', 'success');
                })
                .catch(error => {
                    log(`ç³»ç»Ÿè¿æ¥å¤±è´¥: ${error.message}`, 'error');
                    updateResult('systemStatus', `âŒ ç³»ç»Ÿè¿æ¥å¤±è´¥: ${error.message}`, false);
                });
        }

        function testDatabaseConnection() {
            log('æµ‹è¯•æ•°æ®åº“è¿æ¥...', 'info');
            fetch('http://localhost:9000/loginCheck', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'id=test&passwd=test'
            })
            .then(response => {
                log(`æ•°æ®åº“æµ‹è¯•å“åº”çŠ¶æ€: ${response.status}`, 'info');
                return response.text();
            })
            .then(result => {
                log(`æ•°æ®åº“æµ‹è¯•å“åº”: ${result}`, 'info');
                if (result.includes('è´¦å·æˆ–å¯†ç é”™è¯¯')) {
                    updateResult('systemStatus', 'âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸ï¼ˆè¿”å›é¢„æœŸé”™è¯¯ï¼‰', true);
                    log('æ•°æ®åº“è¿æ¥æ­£å¸¸', 'success');
                } else {
                    updateResult('systemStatus', 'âš ï¸ æ•°æ®åº“å“åº”å¼‚å¸¸', false);
                    log('æ•°æ®åº“å“åº”å¼‚å¸¸', 'warning');
                }
            })
            .catch(error => {
                log(`æ•°æ®åº“æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                updateResult('systemStatus', `âŒ æ•°æ®åº“è¿æ¥å¤±è´¥: ${error.message}`, false);
            });
        }

        function testAdminLogin() {
            const adminId = document.getElementById('adminId').value;
            const adminPass = document.getElementById('adminPass').value;
            
            log(`æµ‹è¯•ç®¡ç†å‘˜ç™»å½•: ${adminId}`, 'info');
            
            fetch('http://localhost:9000/loginCheck', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `id=${encodeURIComponent(adminId)}&passwd=${encodeURIComponent(adminPass)}`
            })
            .then(response => {
                log(`ç®¡ç†å‘˜ç™»å½•å“åº”çŠ¶æ€: ${response.status}`, 'info');
                return response.json();
            })
            .then(result => {
                log(`ç®¡ç†å‘˜ç™»å½•å“åº”: ${JSON.stringify(result)}`, 'info');
                
                if (result.stateCode === "1") {
                    updateResult('adminResult', 'âœ… ç®¡ç†å‘˜ç™»å½•æˆåŠŸï¼å¯ä»¥è®¿é—®ç®¡ç†å‘˜åå°', true);
                    log('ç®¡ç†å‘˜ç™»å½•æˆåŠŸ', 'success');
                } else if (result.stateCode === "0") {
                    updateResult('adminResult', 'âŒ ç®¡ç†å‘˜ç™»å½•å¤±è´¥ - è´¦å·æˆ–å¯†ç é”™è¯¯', false);
                    log('ç®¡ç†å‘˜ç™»å½•å¤±è´¥', 'error');
                } else {
                    updateResult('adminResult', `âš ï¸ æœªçŸ¥å“åº”: ${result.msg || 'æ— æ¶ˆæ¯'}`, false);
                    log(`æœªçŸ¥å“åº”: ${JSON.stringify(result)}`, 'warning');
                }
            })
            .catch(error => {
                log(`ç®¡ç†å‘˜ç™»å½•è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
                updateResult('adminResult', `âŒ ç™»å½•è¯·æ±‚å¤±è´¥: ${error.message}`, false);
            });
        }

        function testReaderLogin(readerId, password, readerName) {
            log(`æµ‹è¯•è¯»è€…ç™»å½•: ${readerName} (${readerId})`, 'info');
            
            fetch('http://localhost:9000/loginCheck', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `id=${encodeURIComponent(readerId)}&passwd=${encodeURIComponent(password)}`
            })
            .then(response => {
                log(`è¯»è€…ç™»å½•å“åº”çŠ¶æ€: ${response.status}`, 'info');
                return response.json();
            })
            .then(result => {
                log(`è¯»è€…ç™»å½•å“åº”: ${JSON.stringify(result)}`, 'info');
                
                if (result.stateCode === "2") {
                    updateResult('readerResult', `âœ… è¯»è€… ${readerName} ç™»å½•æˆåŠŸï¼å¯ä»¥è®¿é—®è¯»è€…é¡µé¢`, true);
                    log(`è¯»è€… ${readerName} ç™»å½•æˆåŠŸ`, 'success');
                } else if (result.stateCode === "0") {
                    updateResult('readerResult', `âŒ è¯»è€… ${readerName} ç™»å½•å¤±è´¥ - è´¦å·æˆ–å¯†ç é”™è¯¯`, false);
                    log(`è¯»è€… ${readerName} ç™»å½•å¤±è´¥`, 'error');
                } else {
                    updateResult('readerResult', `âš ï¸ æœªçŸ¥å“åº”: ${result.msg || 'æ— æ¶ˆæ¯'}`, false);
                    log(`æœªçŸ¥å“åº”: ${JSON.stringify(result)}`, 'warning');
                }
            })
            .catch(error => {
                log(`è¯»è€…ç™»å½•è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
                updateResult('readerResult', `âŒ ç™»å½•è¯·æ±‚å¤±è´¥: ${error.message}`, false);
            });
        }

        function testCustomLogin() {
            const customId = document.getElementById('customId').value;
            const customPass = document.getElementById('customPass').value;
            
            if (!customId || !customPass) {
                updateResult('customResult', 'âŒ è¯·è¾“å…¥è´¦å·IDå’Œå¯†ç ', false);
                return;
            }
            
            log(`æµ‹è¯•è‡ªå®šä¹‰ç™»å½•: ${customId}`, 'info');
            
            fetch('http://localhost:9000/loginCheck', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `id=${encodeURIComponent(customId)}&passwd=${encodeURIComponent(customPass)}`
            })
            .then(response => {
                log(`è‡ªå®šä¹‰ç™»å½•å“åº”çŠ¶æ€: ${response.status}`, 'info');
                return response.json();
            })
            .then(result => {
                log(`è‡ªå®šä¹‰ç™»å½•å“åº”: ${JSON.stringify(result)}`, 'info');
                
                if (result.stateCode === "1") {
                    updateResult('customResult', 'âœ… ç®¡ç†å‘˜ç™»å½•æˆåŠŸï¼', true);
                    log('è‡ªå®šä¹‰ç™»å½•æˆåŠŸï¼ˆç®¡ç†å‘˜ï¼‰', 'success');
                } else if (result.stateCode === "2") {
                    updateResult('customResult', 'âœ… è¯»è€…ç™»å½•æˆåŠŸï¼', true);
                    log('è‡ªå®šä¹‰ç™»å½•æˆåŠŸï¼ˆè¯»è€…ï¼‰', 'success');
                } else if (result.stateCode === "0") {
                    updateResult('customResult', 'âŒ ç™»å½•å¤±è´¥ - è´¦å·æˆ–å¯†ç é”™è¯¯', false);
                    log('è‡ªå®šä¹‰ç™»å½•å¤±è´¥', 'error');
                } else {
                    updateResult('customResult', `âš ï¸ æœªçŸ¥å“åº”: ${result.msg || 'æ— æ¶ˆæ¯'}`, false);
                    log(`æœªçŸ¥å“åº”: ${JSON.stringify(result)}`, 'warning');
                }
            })
            .catch(error => {
                log(`è‡ªå®šä¹‰ç™»å½•è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
                updateResult('customResult', `âŒ ç™»å½•è¯·æ±‚å¤±è´¥: ${error.message}`, false);
            });
        }

        function openMainPage() {
            window.open('http://localhost:9000/', '_blank');
            log('æ‰“å¼€ä¸»ç™»å½•é¡µé¢', 'info');
        }

        function openAdminPage() {
            window.open('http://localhost:9000/admin_main.html', '_blank');
            log('å°è¯•æ‰“å¼€ç®¡ç†å‘˜åå°', 'info');
        }

        function openReaderPage() {
            window.open('http://localhost:9000/reader_main.html', '_blank');
            log('å°è¯•æ‰“å¼€è¯»è€…é¡µé¢', 'info');
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
        window.onload = function() {
            log('å›¾ä¹¦ç®¡ç†ç³»ç»Ÿç™»å½•æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ', 'info');
            log('å¼€å§‹è‡ªåŠ¨æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...', 'info');
            setTimeout(checkSystemStatus, 1000);
        };
    </script>
</body>
</html>
